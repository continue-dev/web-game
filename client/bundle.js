!function(t){var i={};function s(e){if(i[e])return i[e].exports;var o=i[e]={i:e,l:!1,exports:{}};return t[e].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=t,s.c=i,s.d=function(t,i,e){s.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:e})},s.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},s.t=function(t,i){if(1&i&&(t=s(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(s.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var o in t)s.d(e,o,function(i){return t[i]}.bind(null,o));return e},s.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(i,"a",i),i},s.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},s.p="",s(s.s=0)}([function(t,i,s){"use strict";s.r(i);var e=function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.geometry=new THREE.BoxGeometry(.9,.9,.9),this.material=new THREE.MeshLambertMaterial({color:11184810}),this.mesh=new THREE.Mesh(this.geometry,this.material)};function o(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var n=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t)}var i,s,n;return i=t,(s=[{key:"init",value:function(t){this.cubes=[];for(var i=0;i<4;++i){for(var s=[],o=0;o<50;++o){for(var n=0,r=[],h=0;h<50;++h)r.push(new e),r[n].mesh.position.x=o,r[n].mesh.position.y=10*i,r[n].mesh.position.z=h,r[n].mesh.material=new THREE.MeshLambertMaterial({color:6702114}),t.add(r[n].mesh),++n;s.push(r)}this.cubes.push(s)}this.stairs=[];for(var a=30;a<32;++a)for(var m=30;m<32;++m)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*a,this.stairs[this.stairs.length-1].mesh.position.y=2.5,this.stairs[this.stairs.length-1].mesh.position.z=1.2*m,t.add(this.stairs[this.stairs.length-1].mesh);for(var y=28;y<30;++y)for(var l=28;l<30;++l)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*y,this.stairs[this.stairs.length-1].mesh.position.y=5,this.stairs[this.stairs.length-1].mesh.position.z=1.2*l,t.add(this.stairs[this.stairs.length-1].mesh);for(var x=26;x<28;++x)for(var z=26;z<28;++z)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*x,this.stairs[this.stairs.length-1].mesh.position.y=7.5,this.stairs[this.stairs.length-1].mesh.position.z=1.2*z,t.add(this.stairs[this.stairs.length-1].mesh);for(var c=30;c<32;++c)for(var p=30;p<32;++p)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*c,this.stairs[this.stairs.length-1].mesh.position.y=12.5,this.stairs[this.stairs.length-1].mesh.position.z=1.2*p,t.add(this.stairs[this.stairs.length-1].mesh);for(var f=28;f<30;++f)for(var u=28;u<30;++u)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*f,this.stairs[this.stairs.length-1].mesh.position.y=15,this.stairs[this.stairs.length-1].mesh.position.z=1.2*u,t.add(this.stairs[this.stairs.length-1].mesh);for(var d=26;d<28;++d)for(var v=26;v<28;++v)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*d,this.stairs[this.stairs.length-1].mesh.position.y=17.5,this.stairs[this.stairs.length-1].mesh.position.z=1.2*v,t.add(this.stairs[this.stairs.length-1].mesh);for(var g=30;g<32;++g)for(var b=30;b<32;++b)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*g,this.stairs[this.stairs.length-1].mesh.position.y=22.5,this.stairs[this.stairs.length-1].mesh.position.z=1.2*b,t.add(this.stairs[this.stairs.length-1].mesh);for(var w=28;w<30;++w)for(var E=28;E<30;++E)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*w,this.stairs[this.stairs.length-1].mesh.position.y=25,this.stairs[this.stairs.length-1].mesh.position.z=1.2*E,t.add(this.stairs[this.stairs.length-1].mesh);for(var k=26;k<28;++k)for(var M=26;M<28;++M)this.stairs.push(new e),this.stairs[this.stairs.length-1].mesh.position.x=1.2*k,this.stairs[this.stairs.length-1].mesh.position.y=27.5,this.stairs[this.stairs.length-1].mesh.position.z=1.2*M,t.add(this.stairs[this.stairs.length-1].mesh);this.blocks=[];for(var L=0;L<2;++L)for(var P=0;P<2;++P)for(var S=0;S<3;++S)for(var T=0;T<3;++T)for(var R=0;R<3;++R)this.blocks.push(new e),this.blocks[this.blocks.length-1].mesh.position.x=12+1.2*S+25*L*1.2,this.blocks[this.blocks.length-1].mesh.position.y=1.2+1.2*T,this.blocks[this.blocks.length-1].mesh.position.z=12+1.2*R+25*P*1.2,this.blocks[this.blocks.length-1].mesh.material=new THREE.MeshLambertMaterial({color:65280}),t.add(this.blocks[this.blocks.length-1].mesh)}}])&&o(i.prototype,s),n&&o(i,n),t}();function r(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var h={voxel:[{x:1,y:0,z:2,m:15},{x:1,y:0,z:0,m:15},{x:1,y:1,z:2,m:14},{x:1,y:1,z:0,m:14},{x:1,y:2,z:2,m:14},{x:1,y:3,z:3,m:13},{x:2,y:3,z:-1,m:13},{x:1,y:3,z:-1,m:13},{x:1,y:3,z:1,m:14},{x:2,y:3,z:1,m:14},{x:1,y:4,z:2,m:14},{x:1,y:4,z:1,m:14},{x:1,y:4,z:0,m:14},{x:2,y:4,z:1,m:14},{x:2,y:4,z:2,m:14},{x:2,y:4,z:0,m:14},{x:2,y:3,z:2,m:13},{x:2,y:3,z:0,m:13},{x:3,y:2,z:-1,m:13},{x:2,y:2,z:-1,m:13},{x:3,y:2,z:0,m:13},{x:3,y:2,z:1,m:13},{x:3,y:2,z:2,m:13},{x:3,y:2,z:3,m:13},{x:2,y:3,z:3,m:13},{x:2,y:2,z:3,m:13},{x:1,y:2,z:3,m:13},{x:0,y:2,z:3,m:13},{x:2,y:2,z:4,m:13},{x:1,y:2,z:4,m:13},{x:0,y:2,z:2,m:13},{x:0,y:2,z:1,m:13},{x:0,y:2,z:0,m:13},{x:1,y:2,z:0,m:14},{x:1,y:2,z:-1,m:13},{x:2,y:2,z:-2,m:13},{x:1,y:2,z:-2,m:13},{x:2,y:5,z:2,m:13},{x:2,y:5,z:0,m:13},{x:1,y:5,z:0,m:14},{x:1,y:5,z:1,m:14},{x:1,y:5,z:2,m:14},{x:1,y:6,z:1,m:14},{x:2,y:6,z:2,m:14},{x:2,y:6,z:1,m:14},{x:2,y:6,z:0,m:14},{x:1,y:6,z:0,m:14},{x:1,y:6,z:2,m:14},{x:1,y:6,z:3,m:14},{x:1,y:6,z:-1,m:14},{x:1,y:6,z:4,m:13},{x:1,y:6,z:-2,m:13},{x:1,y:6,z:-3,m:14},{x:1,y:6,z:5,m:14},{x:1,y:7,z:1,m:14},{x:1,y:8,z:1,m:14},{x:1,y:8,z:0,m:14},{x:1,y:8,z:-1,m:14},{x:1,y:8,z:2,m:14},{x:1,y:8,z:3,m:14},{x:2,y:8,z:3,m:14},{x:2,y:8,z:2,m:14},{x:2,y:8,z:1,m:14},{x:2,y:8,z:0,m:14},{x:2,y:8,z:-1,m:14},{x:3,y:8,z:0,m:14},{x:3,y:8,z:1,m:14},{x:3,y:8,z:2,m:14},{x:3,y:9,z:2,m:14},{x:3,y:9,z:1,m:14},{x:3,y:9,z:0,m:14},{x:3,y:10,z:2,m:14},{x:3,y:10,z:1,m:14},{x:3,y:10,z:0,m:14},{x:2,y:9,z:-1,m:14},{x:2,y:9,z:0,m:14},{x:2,y:9,z:1,m:14},{x:2,y:9,z:2,m:14},{x:2,y:9,z:3,m:14},{x:1,y:9,z:3,m:14},{x:1,y:9,z:2,m:14},{x:1,y:9,z:1,m:14},{x:1,y:9,z:0,m:14},{x:1,y:9,z:-1,m:14},{x:2,y:10,z:-1,m:14},{x:2,y:10,z:0,m:14},{x:2,y:10,z:1,m:14},{x:2,y:10,z:2,m:14},{x:2,y:10,z:3,m:14},{x:1,y:10,z:3,m:14},{x:1,y:10,z:2,m:14},{x:1,y:10,z:1,m:14},{x:1,y:10,z:0,m:14},{x:1,y:10,z:-1,m:14},{x:0,y:10,z:-1,m:14},{x:0,y:10,z:0,m:14},{x:0,y:10,z:1,m:14},{x:0,y:10,z:2,m:14},{x:0,y:10,z:3,m:14},{x:0,y:9,z:3,m:14},{x:0,y:9,z:2,m:14},{x:0,y:9,z:1,m:14},{x:0,y:9,z:0,m:14},{x:0,y:9,z:-1,m:14},{x:0,y:8,z:-1,m:14},{x:0,y:8,z:0,m:14},{x:0,y:8,z:1,m:14},{x:0,y:8,z:2,m:14},{x:0,y:8,z:3,m:14},{x:3,y:9,z:3,m:8},{x:3,y:9,z:-1,m:8},{x:3,y:8,z:3,m:12},{x:3,y:8,z:-1,m:12},{x:3,y:10,z:3,m:14},{x:3,y:10,z:-1,m:14},{x:4,y:10,z:3,m:3},{x:4,y:10,z:-1,m:3},{x:4,y:11,z:-1,m:3},{x:4,y:11,z:3,m:3},{x:4,y:11,z:2,m:3},{x:4,y:11,z:0,m:3},{x:3,y:10,z:-2,m:3},{x:2,y:10,z:-2,m:3},{x:1,y:10,z:-2,m:3},{x:0,y:10,z:-2,m:3},{x:0,y:9,z:-2,m:3},{x:1,y:9,z:-2,m:3},{x:2,y:9,z:-2,m:3},{x:3,y:9,z:-2,m:3},{x:3,y:8,z:-2,m:3},{x:1,y:8,z:-2,m:3},{x:0,y:8,z:-2,m:3},{x:3,y:11,z:-2,m:3},{x:3,y:11,z:-1,m:3},{x:3,y:11,z:0,m:3},{x:3,y:11,z:1,m:3},{x:3,y:11,z:2,m:3},{x:3,y:11,z:3,m:3},{x:2,y:11,z:3,m:3},{x:2,y:11,z:2,m:3},{x:2,y:11,z:1,m:3},{x:2,y:11,z:0,m:3},{x:2,y:11,z:-1,m:3},{x:2,y:11,z:-2,m:3},{x:1,y:11,z:3,m:3},{x:1,y:11,z:2,m:3},{x:1,y:11,z:1,m:3},{x:1,y:11,z:0,m:3},{x:1,y:11,z:-1,m:3},{x:1,y:11,z:-2,m:3},{x:0,y:11,z:3,m:3},{x:0,y:11,z:2,m:3},{x:0,y:11,z:1,m:3},{x:0,y:11,z:0,m:3},{x:0,y:11,z:-1,m:3},{x:0,y:11,z:-2,m:3},{x:0,y:11,z:4,m:3},{x:1,y:11,z:4,m:3},{x:2,y:11,z:4,m:3},{x:3,y:11,z:4,m:3},{x:3,y:10,z:4,m:3},{x:3,y:9,z:4,m:3},{x:3,y:8,z:4,m:3},{x:2,y:10,z:4,m:3},{x:2,y:9,z:4,m:3},{x:1,y:10,z:4,m:3},{x:1,y:9,z:4,m:3},{x:1,y:8,z:4,m:3},{x:0,y:10,z:4,m:3},{x:0,y:9,z:4,m:3},{x:0,y:8,z:4,m:3},{x:4,y:10,z:4,m:3},{x:4,y:9,z:4,m:3},{x:4,y:8,z:4,m:3},{x:4,y:7,z:4,m:3},{x:4,y:10,z:-2,m:3},{x:4,y:9,z:-2,m:3},{x:4,y:8,z:-2,m:3},{x:4,y:7,z:-2,m:3},{x:3,y:8,z:5,m:3},{x:3,y:9,z:5,m:3},{x:3,y:10,z:5,m:3},{x:3,y:11,z:5,m:3},{x:2,y:9,z:5,m:14},{x:2,y:11,z:5,m:3},{x:2,y:10,z:5,m:3},{x:1,y:10,z:5,m:3},{x:1,y:9,z:5,m:3},{x:1,y:8,z:5,m:3},{x:0,y:7,z:4,m:3},{x:1,y:12,z:4,m:3},{x:2,y:12,z:4,m:3},{x:3,y:8,z:-3,m:3},{x:3,y:9,z:-3,m:3},{x:3,y:10,z:-3,m:3},{x:3,y:11,z:-3,m:3},{x:2,y:11,z:-3,m:3},{x:2,y:10,z:-3,m:3},{x:1,y:10,z:-3,m:3},{x:1,y:9,z:-3,m:3},{x:1,y:8,z:-3,m:3},{x:2,y:9,z:-3,m:14},{x:0,y:7,z:-2,m:3},{x:1,y:12,z:-2,m:3},{x:2,y:12,z:-2,m:3},{x:3,y:12,z:3,m:3},{x:3,y:12,z:2,m:3},{x:3,y:12,z:1,m:3},{x:3,y:12,z:0,m:3},{x:3,y:12,z:-1,m:3},{x:2,y:12,z:-1,m:3},{x:2,y:12,z:0,m:3},{x:2,y:12,z:1,m:3},{x:2,y:12,z:3,m:3},{x:2,y:12,z:2,m:3},{x:1,y:12,z:3,m:3},{x:1,y:12,z:2,m:3},{x:1,y:12,z:1,m:3},{x:1,y:12,z:0,m:3},{x:1,y:12,z:-1,m:3},{x:-1,y:10,z:-1,m:3},{x:-1,y:10,z:0,m:3},{x:-1,y:10,z:1,m:3},{x:-1,y:10,z:2,m:3},{x:-1,y:10,z:3,m:3},{x:-1,y:9,z:3,m:3},{x:-1,y:9,z:2,m:3},{x:-1,y:9,z:1,m:3},{x:-1,y:9,z:0,m:3},{x:-1,y:9,z:-1,m:3},{x:-1,y:8,z:-1,m:3},{x:-1,y:8,z:0,m:3},{x:-1,y:8,z:1,m:3},{x:-1,y:8,z:2,m:3},{x:-1,y:8,z:3,m:3},{x:2,y:13,z:-1,m:3},{x:2,y:13,z:3,m:3},{x:2,y:13,z:2,m:3},{x:2,y:13,z:0,m:3},{x:3,y:13,z:-1,m:13},{x:3,y:13,z:-2,m:13},{x:4,y:13,z:-2,m:13},{x:4,y:14,z:-2,m:13},{x:3,y:13,z:3,m:13},{x:3,y:13,z:4,m:13},{x:4,y:13,z:4,m:13},{x:4,y:14,z:4,m:13},{x:-1,y:7,z:1,m:3},{x:-1,y:7,z:2,m:3},{x:-1,y:7,z:0,m:3},{x:0,y:2,z:-1,m:13},{x:1,y:3,z:0,m:13},{x:1,y:3,z:2,m:13},{x:-1,y:2,z:1,m:13},{x:-2,y:2,z:1,m:13},{x:-2,y:1,z:1,m:13},{x:-3,y:1,z:1,m:13},{x:-4,y:1,z:1,m:13},{x:-5,y:2,z:1,m:13},{x:-5,y:3,z:1,m:13},{x:-4,y:4,z:1,m:13},{x:-3,y:4,z:1,m:13},{x:2,y:5,z:1,m:13}],material:[{r:1,g:0,b:0,a:1},{r:0,g:1,b:0,a:1},{r:0,g:0,b:1,a:1},{r:1,g:1,b:0,a:1},{r:0,g:1,b:1,a:1},{r:1,g:0,b:1,a:1},{r:1,g:1,b:1,a:1},{r:.4666666666666667,g:.4666666666666667,b:.4666666666666667,a:1},{r:0,g:0,b:0,a:1},{r:.4666666666666667,g:0,b:0,a:1},{r:0,g:.4666666666666667,b:0,a:1},{r:0,g:0,b:.4666666666666667,a:1},{r:1,g:.6,b:.6,a:1},{r:.3333333333333333,g:.3333333333333333,b:.3333333333333333,a:1},{r:1,g:.8,b:.6,a:1},{r:.4,g:.2,b:0,a:1}]},a=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.camera=new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),this.position=new THREE.Vector3(25,4,25),this.direction=new THREE.Vector3(0,0,.1),this.color16=["#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff","#ffffff"],this.material16=[];var s=!0,o=!1,n=void 0;try{for(var r,a=h.voxel[Symbol.iterator]();!(s=(r=a.next()).done);s=!0){for(var m=r.value,y="#",l=[h.material[m.m].r,h.material[m.m].r,h.material[m.m].g,h.material[m.m].g,h.material[m.m].b,h.material[m.m].b],x=0;x<6;++x){var z=Math.floor(15*l[x]),c=z;15==z&&(c="f"),14==z&&(c="e"),13==z&&(c="d"),12==z&&(c="c"),11==z&&(c="b"),10==z&&(c="a"),y+=c+""}this.color16[m.m]=y}}catch(t){o=!0,n=t}finally{try{s||null==a.return||a.return()}finally{if(o)throw n}}var p=!0,f=!1,u=void 0;try{for(var d,v=this.color16[Symbol.iterator]();!(p=(d=v.next()).done);p=!0){var g=d.value;this.material16.push(new THREE.MeshLambertMaterial({color:g}))}}catch(t){f=!0,u=t}finally{try{p||null==v.return||v.return()}finally{if(f)throw u}}this.cubeArray=[];var b=!0,w=!1,E=void 0;try{for(var k,M=h.voxel[Symbol.iterator]();!(b=(k=M.next()).done);b=!0){var L=k.value,P=new e;P.mesh.scale.set(.1,.1,.1),P.mesh.position.set(.1*L.x+25,.1*L.y,.1*L.z+25),P.mesh.material=this.material16[L.m],this.cubeArray.push(P)}}catch(t){w=!0,E=t}finally{try{b||null==M.return||M.return()}finally{if(w)throw E}}this.cube=new e,this.cube.mesh.position.set(this.position.x,this.position.y,this.position.z),this.angle=0,this.target=new THREE.Vector3(0,0,1),this.controller=i,this.controller.handleKeyInput(),this.controller.handleMouseMove(this),this.yVelocity=0,this.gravity=-.0015,this.changeCameraFlag=!1}var i,s,o;return i=t,(s=[{key:"update",value:function(t){(this.controller.moveKeys.get(37)||this.controller.moveKeys.get(65))&&(this.angle+=1,this.direction.x=.1*Math.sin(Math.PI/180*this.angle),this.direction.z=.1*Math.cos(Math.PI/180*this.angle)),(this.controller.moveKeys.get(39)||this.controller.moveKeys.get(68))&&(this.angle-=1,this.direction.x=.1*Math.sin(Math.PI/180*this.angle),this.direction.z=.1*Math.cos(Math.PI/180*this.angle)),(this.controller.moveKeys.get(38)||this.controller.moveKeys.get(87))&&(this.position.x-=this.direction.x,this.position.z-=this.direction.z),(this.controller.moveKeys.get(40)||this.controller.moveKeys.get(83))&&(this.position.x+=this.direction.x,this.position.z+=this.direction.z),this.controller.moveKeys.get(84)&&(this.changeCameraFlag=!0),this.controller.moveKeys.get(89)&&(this.changeCameraFlag=!1),this.yVelocity+=this.gravity,this.camera.position.y+=this.yVelocity,this.position.y+=this.yVelocity;var i=Math.round(this.position.x),s=Math.round((this.position.y-2)/10),e=Math.round(this.position.z);0<i&&i<t.cubes[0].length&&0<e&&e<t.cubes[0][0].length&&(this.position.x<t.cubes[s][i][e].mesh.position.x+1&&this.position.x>t.cubes[s][i][e].mesh.position.x-1&&this.position.z<t.cubes[s][i][e].mesh.position.z+1&&this.position.z>t.cubes[s][i][e].mesh.position.z-1&&this.position.y>t.cubes[s][i][e].mesh.position.y+1&&this.position.y<t.cubes[s][i][e].mesh.position.y+9&&(this.gravity=-.0015,this.yVelocity+=this.gravity,this.position.y+=this.yVelocity,this.jumping=!1),this.position.x<t.cubes[s][i][e].mesh.position.x+1&&this.position.x>t.cubes[s][i][e].mesh.position.x-1&&this.position.y<=t.cubes[s][i][e].mesh.position.y+1&&this.position.y>t.cubes[s][i][e].mesh.position.y&&this.position.z<t.cubes[s][i][e].mesh.position.z+1&&this.position.z>t.cubes[s][i][e].mesh.position.z-1&&(this.yVelocity=0,this.position.y=t.cubes[s][i][e].mesh.position.y+1,this.jumping=!0,this.controller.moveKeys.get(32)&&this.jumping&&(this.gravity=.0015,this.yVelocity=.1,this.camera.position.y+=this.yVelocity,this.position.y+=this.yVelocity)));var o=!0,n=!1,r=void 0;try{for(var a,m=t.stairs[Symbol.iterator]();!(o=(a=m.next()).done);o=!0){var y=a.value;this.position.x<y.mesh.position.x+1&&this.position.x>y.mesh.position.x-1&&this.position.y<=y.mesh.position.y+1&&this.position.y>y.mesh.position.y&&this.position.z<y.mesh.position.z+1&&this.position.z>y.mesh.position.z-1&&(this.yVelocity=0,this.position.y=y.mesh.position.y+1,this.jumping=!0,this.controller.moveKeys.get(32)&&this.jumping&&(this.gravity=.0015,this.yVelocity=.1,this.camera.position.y+=this.yVelocity,this.position.y+=this.yVelocity))}}catch(t){n=!0,r=t}finally{try{o||null==m.return||m.return()}finally{if(n)throw r}}var l=!0,x=!1,z=void 0;try{for(var c,p=t.blocks[Symbol.iterator]();!(l=(c=p.next()).done);l=!0){var f=c.value;this.position.x<f.mesh.position.x+1.2&&this.position.x>f.mesh.position.x&&this.position.y<f.mesh.position.y+1&&this.position.y>f.mesh.position.y-1&&this.position.z<f.mesh.position.z+1&&this.position.z>f.mesh.position.z-1&&(this.position.x=f.mesh.position.x+1.2),this.position.x<f.mesh.position.x&&this.position.x>f.mesh.position.x-1.2&&this.position.y<f.mesh.position.y+1&&this.position.y>f.mesh.position.y-1&&this.position.z<f.mesh.position.z+1&&this.position.z>f.mesh.position.z-1&&(this.position.x=f.mesh.position.x-1.2),this.position.x<f.mesh.position.x+1&&this.position.x>f.mesh.position.x-1&&this.position.y<f.mesh.position.y+1&&this.position.y>f.mesh.position.y-1&&this.position.z<f.mesh.position.z+1.2&&this.position.z>f.mesh.position.z&&(this.position.z=f.mesh.position.z+1.2),this.position.x<f.mesh.position.x+1&&this.position.x>f.mesh.position.x-1&&this.position.y<f.mesh.position.y+1&&this.position.y>f.mesh.position.y-1&&this.position.z<f.mesh.position.z&&this.position.z>f.mesh.position.z-1.2&&(this.position.z=f.mesh.position.z-1.2)}}catch(t){x=!0,z=t}finally{try{l||null==p.return||p.return()}finally{if(x)throw z}}this.cube.mesh.position.set(this.position.x,this.position.y,this.position.z);var u=0,d=!0,v=!1,g=void 0;try{for(var b,w=h.voxel[Symbol.iterator]();!(d=(b=w.next()).done);d=!0){var E=b.value;this.cubeArray[u].mesh.position.set(this.position.x+.1*E.x,this.position.y+.1*E.y-.4,this.position.z+.1*E.z),++u}}catch(t){v=!0,g=t}finally{try{d||null==w.return||w.return()}finally{if(v)throw g}}this.camera.lookAt(this.position.x,this.position.y,this.position.z),this.changeCameraFlag?this.camera.position.set(this.position.x+.1*this.direction.x,this.position.y+0,this.position.z+.1*this.direction.z):this.camera.position.set(this.position.x+30*this.direction.x,this.position.y+1,this.position.z+30*this.direction.z)}}])&&r(i.prototype,s),o&&r(i,o),t}();function m(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var y=Math.PI/2,l=function(){function t(){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.moveKeys=new Map([[37,!1],[38,!1],[39,!1],[40,!1],[87,!1],[65,!1],[83,!1],[68,!1],[32,!1],[84,!1],[89,!1]])}var i,s,e;return i=t,(s=[{key:"handleKeyInput",value:function(){var t=this;document.addEventListener("keydown",function(i){i.preventDefault(),t.moveKeys.has(i.keyCode)&&!t.moveKeys.get(i.keyCode)&&t.moveKeys.set(i.keyCode,!0)}),document.addEventListener("keyup",function(i){i.preventDefault(),t.moveKeys.has(i.keyCode)&&t.moveKeys.get(i.keyCode)&&t.moveKeys.set(i.keyCode,!1)})}},{key:"handleMouseMove",value:function(t){var i=new THREE.Euler(0,0,0,"YXZ");document.addEventListener("mousemove",function(s){i.setFromQuaternion(t.camera.quaternion),i.y-=.004*s.movementX,i.x-=.004*s.movementY,i.x=Math.max(-y,Math.min(y,i.x)),t.camera.quaternion.setFromEuler(i)})}}])&&m(i.prototype,s),e&&m(i,e),t}(),x=function t(){var i=0,s=document.createElement("div");function e(t){return s.appendChild(t.dom),t}function o(t){for(var e=0;e<s.children.length;e++)s.children[e].style.display=e===t?"block":"none";i=t}s.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",s.addEventListener("click",function(t){t.preventDefault(),o(++i%s.children.length)},!1);var n=(performance||Date).now(),r=n,h=0,a=e(new t.Panel("FPS","#0ff","#002")),m=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var y=e(new t.Panel("MB","#f08","#201"));return o(0),{REVISION:16,dom:s,addPanel:e,showPanel:o,begin:function(){n=(performance||Date).now()},end:function(){h++;var t=(performance||Date).now();if(m.update(t-n,200),t>=r+1e3&&(a.update(1e3*h/(t-r),100),r=t,h=0,y)){var i=performance.memory;y.update(i.usedJSHeapSize/1048576,i.jsHeapSizeLimit/1048576)}return t},update:function(){n=this.end()},domElement:s,setMode:o}};x.Panel=function(t,i,s){var e=1/0,o=0,n=Math.round,r=n(window.devicePixelRatio||1),h=80*r,a=48*r,m=3*r,y=2*r,l=3*r,x=15*r,z=74*r,c=30*r,p=document.createElement("canvas");p.width=h,p.height=a,p.style.cssText="width:80px;height:48px";var f=p.getContext("2d");return f.font="bold "+9*r+"px Helvetica,Arial,sans-serif",f.textBaseline="top",f.fillStyle=s,f.fillRect(0,0,h,a),f.fillStyle=i,f.fillText(t,m,y),f.fillRect(l,x,z,c),f.fillStyle=s,f.globalAlpha=.9,f.fillRect(l,x,z,c),{dom:p,update:function(a,u){e=Math.min(e,a),o=Math.max(o,a),f.fillStyle=s,f.globalAlpha=1,f.fillRect(0,0,h,x),f.fillStyle=i,f.fillText(n(a)+" "+t+" ("+n(e)+"-"+n(o)+")",m,y),f.drawImage(p,l+r,x,z-r,c,l,x,z-r,c),f.fillRect(l+z-r,x,r,c),f.fillStyle=s,f.globalAlpha=.9,f.fillRect(l+z-r,x,r,n((1-a/u)*c))}}};var z=x;function c(t,i){for(var s=0;s<i.length;s++){var e=i[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}var p=function(){function t(i){!function(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}(this,t),this.scene=new THREE.Scene,this.stage=new n,this.renderer=new THREE.WebGLRenderer({antialias:!0}),this.socket=io("/",{path:"/ws/socket.io"}),this.connected=!1,this.player=i,this.players=new Map,this.id=Math.floor(1e4*Math.random())}var i,s,o;return i=t,(s=[{key:"init",value:function(){var t=this;this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.setClearColor(43775,1),document.body.appendChild(this.renderer.domElement),this.renderer.domElement.addEventListener("click",function(){t.renderer.domElement.requestPointerLock()}),this.stage.init(this.scene);var i=new THREE.DirectionalLight(16777215);i.position.set(25,1e3,25),this.scene.add(i);var s=8947848;this.directionalLight1=new THREE.DirectionalLight(s),this.directionalLight1.position.set(-2500,100,2500),this.scene.add(this.directionalLight1),this.directionalLight2=new THREE.DirectionalLight(s),this.directionalLight2.position.set(2500,100,-2500),this.scene.add(this.directionalLight2),this.directionalLight3=new THREE.DirectionalLight(s),this.directionalLight3.position.set(2500,100,2500),this.scene.add(this.directionalLight3),this.directionalLight4=new THREE.DirectionalLight(s),this.directionalLight4.position.set(-2500,100,-2500),this.scene.add(this.directionalLight4);var e=new THREE.SpotLight(16777215,2,40,Math.PI/2,1,.5);e.position.set(25,35,25),this.scene.add(e);var o=!0,n=!1,r=void 0;try{for(var h,a=this.player.cubeArray[Symbol.iterator]();!(o=(h=a.next()).done);o=!0){var m=h.value;this.scene.add(m.mesh)}}catch(t){n=!0,r=t}finally{try{o||null==a.return||a.return()}finally{if(n)throw r}}this.stats=new z,document.body.appendChild(this.stats.dom)}},{key:"connect",value:function(){var t=this;this.socket.emit("connected",{clientID:this.id,position:this.player.position}),this.socket.on("disconnect",function(){}),this.socket.on("connected",function(i){i.newUser.clientID!==t.id?t.addUser(i.newUser):(i.currentUsers.filter(function(i){return!t.players.has(i.clientID)}).forEach(function(i){t.addUser(i)}),t.connected=!0)}),this.socket.on("disconnected",function(i){var s=t.players.get(i);t.scene.remove(s.mesh),s.geometry.dispose(),s.material.dispose(),t.players.delete(i)}),this.socket.on("updatePosition",function(i){i.clientID!==t.id&&t.connected&&t.updatePosition(i)})}},{key:"addUser",value:function(t){var i=new e;i.mesh.position.x=t.position.x,i.mesh.position.y=t.position.y,i.mesh.position.z=t.position.z;var s=!0,o=!1,n=void 0;try{for(var r,h=i.cubeArray[Symbol.iterator]();!(s=(r=h.next()).done);s=!0){var a=r.value;this.scene.add(a.mesh)}}catch(t){o=!0,n=t}finally{try{s||null==h.return||h.return()}finally{if(o)throw n}}this.players.set(t.clientID,i)}},{key:"updatePosition",value:function(t){var i=this.players.get(t.clientID);i.mesh.position.x=t.position.x,i.mesh.position.y=t.position.y,i.mesh.position.z=t.position.z}},{key:"render",value:function(){this.renderer.render(this.scene,this.player.camera)}}])&&c(i.prototype,s),o&&c(i,o),t}();document.addEventListener("DOMContentLoaded",function(){var t=new p(new a(new l));t.init(),t.scene.add(t.player.camera),t.connect(),function i(){t.stats.update(),t.player.prevPos=Object.assign({},t.player.position),t.player.update(t.stage),JSON.stringify(t.player.position)!=JSON.stringify(t.player.prevPos)&&t.socket.emit("updatePosition",{clientID:t.id,position:t.player.position}),t.render(),requestAnimationFrame(i)}()})}]);
//# sourceMappingURL=bundle.js.map